-- Mobile Fly Camera System by sherikyt
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local config = {
    maxCameras = 5,
    flySpeed = 25,
    cameraFOV = 70
}

local state = {
    cameras = {},
    currentCameraIndex = 0,
    isMonitoring = false,
    isFlying = false,
    menuVisible = true,
    flyPosition = Vector3.new(0, 0, 0),
    zoomLevel = 1
}

-- GUI
local gui = Instance.new("ScreenGui")
gui.Name = "FlyCameraSystem"
gui.Parent = playerGui

-- Simple status display
local status = Instance.new("TextLabel")
status.Size = UDim2.new(0, 250, 0, 80)
status.Position = UDim2.new(0, 10, 0, 10)
status.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
status.BackgroundTransparency = 0.3
status.Text = "Fly Camera System\nby sherikyt\nCameras: 0/5"
status.TextColor3 = Color3.fromRGB(255, 255, 255)
status.Font = Enum.Font.Gotham
status.TextSize = 14
status.TextWrapped = true
status.Parent = gui

local statusCorner = Instance.new("UICorner")
statusCorner.CornerRadius = UDim.new(0, 10)
statusCorner.Parent = status

-- Function to create simple button
local function createButton(name, text, position, color)
    local button = Instance.new("TextButton")
    button.Name = name
    button.Size = UDim2.new(0, 120, 0, 50)
    button.Position = position
    button.BackgroundColor3 = color
    button.Text = text
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Font = Enum.Font.GothamBold
    button.TextSize = 14
    button.TextWrapped = true
    button.Parent = gui
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 10)
    btnCorner.Parent = button
    
    button.MouseButton1Down:Connect(function()
        button.BackgroundTransparency = 0.3
    end)
    
    button.MouseButton1Up:Connect(function()
        button.BackgroundTransparency = 0
    end)
    
    return button
end

-- Main buttons
local flyBtn = createButton("FlyBtn", "FREE CAMERA", UDim2.new(0, 10, 0, 100), Color3.fromRGB(0, 150, 255))
local saveBtn = createButton("SaveBtn", "SAVE POSITION", UDim2.new(0, 140, 0, 100), Color3.fromRGB(0, 200, 100))
local viewBtn = createButton("ViewBtn", "VIEW CAMERAS", UDim2.new(0, 10, 0, 160), Color3.fromRGB(150, 0, 255))
local clearBtn = createButton("ClearBtn", "CLEAR ALL", UDim2.new(0, 140, 0, 160), Color3.fromRGB(255, 50, 50))
local exitBtn = createButton("ExitBtn", "EXIT", UDim2.new(0, 10, 0, 220), Color3.fromRGB(100, 100, 100))

-- Hide exit button initially
exitBtn.Visible = false

-- Flying controls
local flyControls = Instance.new("Frame")
flyControls.Size = UDim2.new(1, 0, 0, 150)
flyControls.Position = UDim2.new(0, 0, 1, -150)
flyControls.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
flyControls.BackgroundTransparency = 0.7
flyControls.Visible = false
flyControls.Parent = gui

-- Simple flying buttons
local function createFlyButton(name, text, position)
    local btn = Instance.new("TextButton")
    btn.Name = name
    btn.Size = UDim2.new(0, 70, 0, 70)
    btn.Position = position
    btn.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 20
    btn.Parent = flyControls
    
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 10)
    
    return btn
end

local upBtn = createFlyButton("UpBtn", "⬆", UDim2.new(0.5, -35, 0, 10))
local downBtn = createFlyButton("DownBtn", "⬇", UDim2.new(0.5, -35, 1, -80))
local leftBtn = createFlyButton("LeftBtn", "⬅", UDim2.new(0.2, -35, 0.5, -35))
local rightBtn = createFlyButton("RightBtn", "➡", UDim2.new(0.8, -35, 0.5, -35))
local forwardBtn = createFlyButton("ForwardBtn", "F", UDim2.new(0.35, -35, 0.3, -35))
local backBtn = createFlyButton("BackBtn", "B", UDim2.new(0.65, -35, 0.3, -35))

-- Viewing controls
local viewControls = Instance.new("Frame")
viewControls.Size = UDim2.new(1, 0, 0, 100)
viewControls.Position = UDim2.new(0, 0, 1, -100)
viewControls.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
viewControls.BackgroundTransparency = 0.7
viewControls.Visible = false
viewControls.Parent = gui

local prevBtn = createButton("PrevBtn", "⬅ PREV", UDim2.new(0.1, 0, 0, 20), Color3.fromRGB(80, 80, 100))
prevBtn.Parent = viewControls
prevBtn.Size = UDim2.new(0, 100, 0, 60)

local nextBtn = createButton("NextBtn", "NEXT ➡", UDim2.new(0.9, -100, 0, 20), Color3.fromRGB(80, 80, 100))
nextBtn.Parent = viewControls
nextBtn.Size = UDim2.new(0, 100, 0, 60)

-- Camera functions
local function createCameraMarker(position, index)
    local marker = Instance.new("Part")
    marker.Name = "Camera_" .. index
    marker.Size = Vector3.new(2, 2, 2)
    marker.Position = position
    marker.Anchored = true
    marker.CanCollide = false
    marker.Transparency = 0.5
    marker.Color = Color3.fromRGB(0, 150, 255)
    marker.Parent = Workspace
    
    local light = Instance.new("PointLight")
    light.Color = Color3.fromRGB(0, 150, 255)
    light.Brightness = 2
    light.Range = 10
    light.Parent = marker
    
    return marker
end

local function updateStatus()
    local count = #state.cameras
    if state.isFlying then
        status.Text = string.format("FLYING MODE\nCameras: %d/5\nUse buttons to move", count)
    elseif state.isMonitoring then
        status.Text = string.format("VIEWING MODE\nCamera: %d/%d\n← → to switch", 
            state.currentCameraIndex, count)
    else
        status.Text = string.format("Fly Camera System\nby sherikyt\nCameras: %d/5", count)
    end
end

local function saveCamera()
    if #state.cameras >= config.maxCameras then
        status.Text = "MAX 5 CAMERAS REACHED"
        return
    end
    
    local camera = Workspace.CurrentCamera
    local position = camera.CFrame.Position
    local index = #state.cameras + 1
    
    createCameraMarker(position, index)
    
    table.insert(state.cameras, {
        position = position,
        index = index
    })
    
    updateStatus()
end

local function clearAllCameras()
    for _, part in pairs(Workspace:GetChildren()) do
        if string.find(part.Name, "Camera_") then
            part:Destroy()
        end
    end
    state.cameras = {}
    state.currentCameraIndex = 0
    updateStatus()
end

-- Flying system
local function startFlying()
    if state.isFlying then return end
    
    state.isFlying = true
    local camera = Workspace.CurrentCamera
    state.flyPosition = camera.CFrame.Position
    
    -- Switch camera
    camera.CameraType = Enum.CameraType.Scriptable
    
    -- Show/hide UI
    flyControls.Visible = true
    exitBtn.Visible = true
    flyBtn.Visible = false
    saveBtn.Visible = false
    viewBtn.Visible = false
    clearBtn.Visible = false
    
    updateStatus()
end

local function stopFlying()
    if not state.isFlying then return end
    
    state.isFlying = false
    
    -- Return camera
    Workspace.CurrentCamera.CameraType = Enum.CameraType.Custom
    
    -- Show/hide UI
    flyControls.Visible = false
    exitBtn.Visible = false
    flyBtn.Visible = true
    saveBtn.Visible = true
    viewBtn.Visible = true
    clearBtn.Visible = true
    
    updateStatus()
end

-- Viewing system
local function startViewing()
    if #state.cameras == 0 then
        status.Text = "NO CAMERAS SAVED"
        return
    end
    
    state.isMonitoring = true
    state.currentCameraIndex = 1
    
    -- Switch camera
    Workspace.CurrentCamera.CameraType = Enum.CameraType.Scriptable
    
    -- Show/hide UI
    viewControls.Visible = true
    exitBtn.Visible = true
    flyBtn.Visible = false
    saveBtn.Visible = false
    viewBtn.Visible = false
    clearBtn.Visible = false
    
    updateStatus()
end

local function stopViewing()
    state.isMonitoring = false
    
    -- Return camera
    Workspace.CurrentCamera.CameraType = Enum.CameraType.Custom
    
    -- Show/hide UI
    viewControls.Visible = false
    exitBtn.Visible = false
    flyBtn.Visible = true
    saveBtn.Visible = true
    viewBtn.Visible = true
    clearBtn.Visible = true
    
    updateStatus()
end

local function switchCamera(direction)
    if #state.cameras == 0 then return end
    
    if direction == "next" then
        state.currentCameraIndex = state.currentCameraIndex + 1
        if state.currentCameraIndex > #state.cameras then
            state.currentCameraIndex = 1
        end
    elseif direction == "prev" then
        state.currentCameraIndex = state.currentCameraIndex - 1
        if state.currentCameraIndex < 1 then
            state.currentCameraIndex = #state.cameras
        end
    end
    
    updateStatus()
end

-- Flying movement
local flyDirections = {
    forward = false,
    back = false,
    left = false,
    right = false,
    up = false,
    down = false
}

-- Button press events
forwardBtn.MouseButton1Down:Connect(function()
    flyDirections.forward = true
end)
forwardBtn.MouseButton1Up:Connect(function()
    flyDirections.forward = false
end)

backBtn.MouseButton1Down:Connect(function()
    flyDirections.back = true
end)
backBtn.MouseButton1Up:Connect(function()
    flyDirections.back = false
end)

leftBtn.MouseButton1Down:Connect(function()
    flyDirections.left = true
end)
leftBtn.MouseButton1Up:Connect(function()
    flyDirections.left = false
end)

rightBtn.MouseButton1Down:Connect(function()
    flyDirections.right = true
end)
rightBtn.MouseButton1Up:Connect(function()
    flyDirections.right = false
end)

upBtn.MouseButton1Down:Connect(function()
    flyDirections.up = true
end)
upBtn.MouseButton1Up:Connect(function()
    flyDirections.up = false
end)

downBtn.MouseButton1Down:Connect(function()
    flyDirections.down = true
end)
downBtn.MouseButton1Up:Connect(function()
    flyDirections.down = false
end)

-- Main button events
flyBtn.MouseButton1Click:Connect(startFlying)
saveBtn.MouseButton1Click:Connect(saveCamera)
viewBtn.MouseButton1Click:Connect(startViewing)
clearBtn.MouseButton1Click:Connect(clearAllCameras)
exitBtn.MouseButton1Click:Connect(function()
    if state.isFlying then
        stopFlying()
    elseif state.isMonitoring then
        stopViewing()
    end
end)

-- Viewing controls
prevBtn.MouseButton1Click:Connect(function()
    switchCamera("prev")
end)

nextBtn.MouseButton1Click:Connect(function()
    switchCamera("next")
end)

-- Main game loop
local connection
connection = RunService.Heartbeat:Connect(function(delta)
    if state.isFlying then
        local camera = Workspace.CurrentCamera
        
        -- Calculate movement
        local move = Vector3.new(0, 0, 0)
        
        if flyDirections.forward then
            move = move + camera.CFrame.LookVector
        end
        if flyDirections.back then
            move = move - camera.CFrame.LookVector
        end
        if flyDirections.right then
            move = move + camera.CFrame.RightVector
        end
        if flyDirections.left then
            move = move - camera.CFrame.RightVector
        end
        if flyDirections.up then
            move = move + Vector3.new(0, 1, 0)
        end
        if flyDirections.down then
            move = move - Vector3.new(0, 1, 0)
        end
        
        -- Apply movement
        if move.Magnitude > 0 then
            move = move.Unit * config.flySpeed * delta
            state.flyPosition = state.flyPosition + move
        end
        
        -- Update camera
        camera.CFrame = CFrame.new(state.flyPosition, 
            state.flyPosition + camera.CFrame.LookVector)
        camera.FieldOfView = config.cameraFOV
        
    elseif state.isMonitoring and #state.cameras > 0 then
        local camera = Workspace.CurrentCamera
        local camData = state.cameras[state.currentCameraIndex]
        
        if camData then
            -- Look at camera position from slight offset
            local viewPos = camData.position + Vector3.new(0, 0, -10)
            camera.CFrame = CFrame.new(viewPos, camData.position)
            camera.FieldOfView = config.cameraFOV
        end
    end
end)

-- Mobile touch controls for rotation
local touchStart = nil
local originalYaw = 0
local originalPitch = 0

UserInputService.TouchStarted:Connect(function(touch)
    if not state.isFlying then return end
    
    touchStart = touch.Position
    local camera = Workspace.CurrentCamera
    local look = camera.CFrame.LookVector
    
    -- Calculate current yaw and pitch
    originalYaw = math.atan2(look.Z, look.X)
    originalPitch = math.asin(look.Y)
end)

UserInputService.InputChanged:Connect(function(input)
    if not state.isFlying or not touchStart or input.UserInputType ~= Enum.UserInputType.Touch then
        return
    end
    
    local delta = input.Position - touchStart
    local sensitivity = 0.01
    
    local yaw = originalYaw - delta.X * sensitivity
    local pitch = originalPitch - delta.Y * sensitivity
    pitch = math.clamp(pitch, -1.5, 1.5)
    
    local camera = Workspace.CurrentCamera
    local look = Vector3.new(
        math.cos(yaw) * math.cos(pitch),
        math.sin(pitch),
        math.sin(yaw) * math.cos(pitch)
    )
    
    camera.CFrame = CFrame.new(state.flyPosition, state.flyPosition + look)
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch then
        touchStart = nil
    end
end)

-- Cleanup
gui.Destroying:Connect(function()
    if connection then
        connection:Disconnect()
    end
    clearAllCameras()
end)

updateStatus()

print("Mobile Fly Camera System loaded")
print("1. FREE CAMERA - Fly around")
print("2. SAVE POSITION - Save camera")
print("3. VIEW CAMERAS - View saved")
