-- Free Camera Mobile System by sherikyt
-- For mobile devices - Tap camera icon to toggle

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local StarterGui = game:GetService("StarterGui")

-- Check if mobile
local IS_MOBILE = UserInputService.TouchEnabled

if not IS_MOBILE then
    warn("This script is designed for mobile devices!")
    return
end

-- Configuration
local CONFIG = {
    MoveSpeed = 10,
    Sensitivity = 0.3,
    Smoothness = 0.8,
    JoystickSize = 100,
    ButtonSize = 50
}

-- Variables
local player = Players.LocalPlayer
local camera = workspace.CurrentCamera
local freeCameraEnabled = false
local originalCFrame
local originalCameraType
local cameraCFrame = CFrame.new()

-- Movement vectors
local movementVector = Vector3.new()
local joystickTouch = nil
local lookTouch = nil
local lookDelta = Vector2.new()

-- UI Elements
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FreeCameraMobileUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = StarterGui

-- Toggle Button (Left Top Corner)
local toggleButton = Instance.new("ImageButton")
toggleButton.Name = "ToggleButton"
toggleButton.Image = "rbxassetid://7072717646" -- Camera icon
toggleButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
toggleButton.BackgroundTransparency = 0.3
toggleButton.Position = UDim2.new(0, 10, 0, 10)
toggleButton.Size = UDim2.new(0, CONFIG.ButtonSize, 0, CONFIG.ButtonSize)
toggleButton.Parent = screenGui

-- Control Panel (appears next to button when active)
local controlPanel = Instance.new("Frame")
controlPanel.Name = "ControlPanel"
controlPanel.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
controlPanel.BackgroundTransparency = 0.2
controlPanel.BorderSizePixel = 0
controlPanel.Position = UDim2.new(0, CONFIG.ButtonSize + 20, 0, 10)
controlPanel.Size = UDim2.new(0, 180, 0, 180)
controlPanel.Visible = false
controlPanel.Parent = screenGui

-- Panel Header
local panelHeader = Instance.new("Frame")
panelHeader.Name = "PanelHeader"
panelHeader.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
panelHeader.BorderSizePixel = 0
panelHeader.Size = UDim2.new(1, 0, 0, 30)
panelHeader.Parent = controlPanel

local panelTitle = Instance.new("TextLabel")
panelTitle.Name = "PanelTitle"
panelTitle.Text = "FREE CAMERA"
panelTitle.TextColor3 = Color3.fromRGB(100, 255, 100)
panelTitle.TextSize = 14
panelTitle.Font = Enum.Font.GothamBold
panelTitle.BackgroundTransparency = 1
panelTitle.Size = UDim2.new(1, 0, 1, 0)
panelTitle.Parent = panelHeader

-- Joystick Area
local joystickArea = Instance.new("Frame")
joystickArea.Name = "JoystickArea"
joystickArea.BackgroundTransparency = 1
joystickArea.Position = UDim2.new(0, 10, 0, 40)
joystickArea.Size = UDim2.new(0, CONFIG.JoystickSize, 0, CONFIG.JoystickSize)
joystickArea.Parent = controlPanel

-- Joystick Background
local joystickBg = Instance.new("Frame")
joystickBg.Name = "JoystickBg"
joystickBg.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
joystickBg.BackgroundTransparency = 0.5
joystickBg.BorderSizePixel = 0
joystickBg.Size = UDim2.new(1, 0, 1, 0)
joystickBg.Parent = joystickArea

-- Joystick Knob
local joystickKnob = Instance.new("Frame")
joystickKnob.Name = "JoystickKnob"
joystickKnob.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
joystickKnob.BackgroundTransparency = 0.3
joystickKnob.BorderSizePixel = 0
joystickKnob.Size = UDim2.new(0, 40, 0, 40)
joystickKnob.AnchorPoint = Vector2.new(0.5, 0.5)
joystickKnob.Position = UDim2.new(0.5, 0, 0.5, 0)
joystickKnob.Parent = joystickArea

-- Joystick Label
local joystickLabel = Instance.new("TextLabel")
joystickLabel.Name = "JoystickLabel"
joystickLabel.Text = "MOVE"
joystickLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
joystickLabel.TextSize = 12
joystickLabel.Font = Enum.Font.Gotham
joystickLabel.BackgroundTransparency = 1
joystickLabel.Position = UDim2.new(0, 0, 1, 5)
joystickLabel.Size = UDim2.new(1, 0, 0, 15)
joystickLabel.Parent = joystickArea

-- Speed Controls (right side)
local speedArea = Instance.new("Frame")
speedArea.Name = "SpeedArea"
speedArea.BackgroundTransparency = 1
speedArea.Position = UDim2.new(1, -80, 0, 40)
speedArea.Size = UDim2.new(0, 70, 0, CONFIG.JoystickSize)
speedArea.Parent = controlPanel

local speedLabel = Instance.new("TextLabel")
speedLabel.Name = "SpeedLabel"
speedLabel.Text = "SPEED: " .. CONFIG.MoveSpeed
speedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
speedLabel.TextSize = 12
speedLabel.Font = Enum.Font.GothamBold
speedLabel.BackgroundTransparency = 1
speedLabel.Size = UDim2.new(1, 0, 0, 20)
speedLabel.Parent = speedArea

-- Speed Up Button
local speedUpButton = Instance.new("TextButton")
speedUpButton.Name = "SpeedUpButton"
speedUpButton.Text = "+"
speedUpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
speedUpButton.TextSize = 18
speedUpButton.Font = Enum.Font.GothamBold
speedUpButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
speedUpButton.Position = UDim2.new(0, 0, 0.3, 0)
speedUpButton.Size = UDim2.new(1, 0, 0, 30)
speedUpButton.Parent = speedArea

-- Speed Down Button
local speedDownButton = Instance.new("TextButton")
speedDownButton.Name = "SpeedDownButton"
speedDownButton.Text = "-"
speedDownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
speedDownButton.TextSize = 18
speedDownButton.Font = Enum.Font.GothamBold
speedDownButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
speedDownButton.Position = UDim2.new(0, 0, 0.7, 0)
speedDownButton.Size = UDim2.new(1, 0, 0, 30)
speedDownButton.Parent = speedArea

-- Instructions
local instructions = Instance.new("TextLabel")
instructions.Name = "Instructions"
instructions.Text = "Drag screen to look around"
instructions.TextColor3 = Color3.fromRGB(180, 180, 180)
instructions.TextSize = 11
instructions.Font = Enum.Font.Gotham
instructions.TextWrapped = true
instructions.BackgroundTransparency = 1
instructions.Position = UDim2.new(0, 10, 1, -45)
instructions.Size = UDim2.new(1, -20, 0, 35)
instructions.Parent = controlPanel

-- Exit Button (small at bottom)
local exitButton = Instance.new("TextButton")
exitButton.Name = "ExitButton"
exitButton.Text = "EXIT"
exitButton.TextColor3 = Color3.fromRGB(255, 100, 100)
exitButton.TextSize = 12
exitButton.Font = Enum.Font.GothamBold
exitButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
exitButton.BackgroundTransparency = 0.5
exitButton.Position = UDim2.new(0.5, -40, 1, -25)
exitButton.Size = UDim2.new(0, 80, 0, 20)
exitButton.Visible = false
exitButton.Parent = screenGui

-- Enable free camera
local function enableFreeCamera()
    freeCameraEnabled = true
    
    -- Store original camera state
    originalCFrame = camera.CFrame
    originalCameraType = camera.CameraType
    
    -- Start with current camera position
    cameraCFrame = camera.CFrame
    
    -- Enable camera control
    camera.CameraType = Enum.CameraType.Scriptable
    
    -- Update UI
    toggleButton.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
    controlPanel.Visible = true
    exitButton.Visible = true
end

-- Disable free camera
local function disableFreeCamera()
    freeCameraEnabled = false
    
    -- Reset camera
    camera.CameraType = originalCameraType or Enum.CameraType.Custom
    if originalCFrame then
        camera.CFrame = originalCFrame
    end
    
    -- Reset movement
    movementVector = Vector3.new()
    joystickTouch = nil
    lookTouch = nil
    lookDelta = Vector2.new()
    
    -- Reset joystick visual
    joystickKnob.Position = UDim2.new(0.5, 0, 0.5, 0)
    
    -- Update UI
    toggleButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    controlPanel.Visible = false
    exitButton.Visible = false
end

-- Toggle free camera
toggleButton.MouseButton1Click:Connect(function()
    if freeCameraEnabled then
        disableFreeCamera()
    else
        enableFreeCamera()
    end
end)

-- Exit button
exitButton.MouseButton1Click:Connect(function()
    disableFreeCamera()
end)

-- Speed controls
speedUpButton.MouseButton1Click:Connect(function()
    CONFIG.MoveSpeed = math.min(CONFIG.MoveSpeed + 2, 30)
    speedLabel.Text = "SPEED: " .. CONFIG.MoveSpeed
end)

speedDownButton.MouseButton1Click:Connect(function()
    CONFIG.MoveSpeed = math.max(CONFIG.MoveSpeed - 2, 1)
    speedLabel.Text = "SPEED: " .. CONFIG.MoveSpeed
end)

-- Joystick controls
joystickArea.InputBegan:Connect(function(input)
    if freeCameraEnabled and input.UserInputType == Enum.UserInputType.Touch and not joystickTouch then
        joystickTouch = input
    end
end)

joystickArea.InputChanged:Connect(function(input)
    if freeCameraEnabled and input == joystickTouch then
        local touchPos = input.Position
        local areaPos = joystickArea.AbsolutePosition
        local areaSize = joystickArea.AbsoluteSize
        
        local center = areaPos + areaSize / 2
        local delta = touchPos - center
        local maxDistance = CONFIG.JoystickSize / 2 - 20
        
        -- Clamp joystick position
        local distance = math.min(delta.Magnitude, maxDistance)
        local direction = delta.Magnitude > 0 and delta.Unit or Vector2.new(0, 0)
        
        -- Update joystick visual
        local knobPos = direction * distance
        joystickKnob.Position = UDim2.new(
            0.5, knobPos.X,
            0.5, knobPos.Y
        )
        
        -- Calculate movement vector
        if distance > 5 then  -- Dead zone
            movementVector = Vector3.new(
                direction.X * (distance / maxDistance),
                0,
                -direction.Y * (distance / maxDistance)
            )
        else
            movementVector = Vector3.new()
        end
    end
end)

joystickArea.InputEnded:Connect(function(input)
    if input == joystickTouch then
        joystickTouch = nil
        movementVector = Vector3.new()
        -- Reset joystick visual
        joystickKnob.Position = UDim2.new(0.5, 0, 0.5, 0)
    end
end)

-- Look controls (drag anywhere on screen)
screenGui.InputBegan:Connect(function(input)
    if freeCameraEnabled and input.UserInputType == Enum.UserInputType.Touch and not lookTouch then
        lookTouch = input
        lookDelta = Vector2.new()
    end
end)

screenGui.InputChanged:Connect(function(input)
    if freeCameraEnabled and input == lookTouch then
        lookDelta = input.Delta
    end
end)

screenGui.InputEnded:Connect(function(input)
    if input == lookTouch then
        lookTouch = nil
        lookDelta = Vector2.new()
    end
end)

-- Camera update loop
RunService.RenderStepped:Connect(function(deltaTime)
    if freeCameraEnabled then
        -- Apply rotation from look controls
        if lookDelta.Magnitude > 0 then
            local yaw = -lookDelta.X * CONFIG.Sensitivity * 0.01
            local pitch = -lookDelta.Y * CONFIG.Sensitivity * 0.01
            
            -- Apply rotation to camera
            local yawRot = CFrame.fromAxisAngle(Vector3.new(0, 1, 0), yaw)
            local pitchRot = CFrame.fromAxisAngle(cameraCFrame.RightVector, pitch)
            
            cameraCFrame = cameraCFrame * yawRot * pitchRot
        end
        
        -- Apply movement
        if movementVector.Magnitude > 0 then
            local moveDelta = movementVector * CONFIG.MoveSpeed * deltaTime
            
            -- Transform movement to camera space
            local forward = cameraCFrame.LookVector
            local right = cameraCFrame.RightVector
            local up = Vector3.new(0, 1, 0)  -- Always move up/down relative to world
            
            local worldMove = 
                right * moveDelta.X +
                up * moveDelta.Z +  -- Using Z for up/down (joystick vertical)
                forward * moveDelta.Z * 0.5  -- Forward movement
            
            cameraCFrame = cameraCFrame + worldMove
        end
        
        -- Apply camera update
        camera.CFrame = cameraCFrame
    end
end)

-- Cleanup
player.CharacterAdded:Connect(function()
    if freeCameraEnabled then
        disableFreeCamera()
    end
end)

-- Auto-disable when menu opens
UserInputService.MenuOpened:Connect(function()
    if freeCameraEnabled then
        disableFreeCamera()
    end
end)

-- Handle GUI removal
screenGui.AncestryChanged:Connect(function()
    if not screenGui.Parent then
        if freeCameraEnabled then
            disableFreeCamera()
        end
    end
end)

print("==================================")
print("Free Camera Mobile by sherikyt")
print("Menu location: LEFT TOP CORNER")
print("Tap camera icon to toggle")
print("==================================")
