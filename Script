-- Free Camera Mobile System by sherikyt
-- For mobile devices - Tap camera icon to toggle

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local StarterGui = game:GetService("StarterGui")

-- Check if mobile
local IS_MOBILE = UserInputService.TouchEnabled

if not IS_MOBILE then
    warn("This script is designed for mobile devices!")
    return
end

-- Configuration
local CONFIG = {
    MoveSpeed = 10,
    Sensitivity = 0.5,
    Smoothness = 0.8,
    JoystickSize = 120,
    ButtonSize = 60
}

-- Variables
local player = Players.LocalPlayer
local camera = workspace.CurrentCamera
local freeCameraEnabled = false
local originalCFrame
local originalCameraType
local cameraCFrame = CFrame.new()

-- Movement vectors
local movementVector = Vector3.new()
local joystickTouch = nil
local lookTouch = nil
local lookDelta = Vector2.new()

-- UI Elements
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FreeCameraMobileUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = StarterGui

-- Toggle Button (Camera icon in corner)
local toggleButton = Instance.new("ImageButton")
toggleButton.Name = "ToggleButton"
toggleButton.Image = "rbxassetid://7072717646" -- Camera icon
toggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
toggleButton.BackgroundTransparency = 0.3
toggleButton.Position = UDim2.new(1, -70, 0, 20)
toggleButton.Size = UDim2.new(0, 50, 0, 50)
toggleButton.AnchorPoint = Vector2.new(1, 0)
toggleButton.Parent = screenGui

local toggleLabel = Instance.new("TextLabel")
toggleLabel.Name = "ToggleLabel"
toggleLabel.Text = "Free Cam"
toggleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleLabel.TextSize = 12
toggleLabel.Font = Enum.Font.GothamBold
toggleLabel.BackgroundTransparency = 1
toggleLabel.Position = UDim2.new(0, 0, 1, 5)
toggleLabel.Size = UDim2.new(1, 0, 0, 20)
toggleLabel.Parent = toggleButton

-- Control Panel (shows when active)
local controlPanel = Instance.new("Frame")
controlPanel.Name = "ControlPanel"
controlPanel.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
controlPanel.BackgroundTransparency = 0.7
controlPanel.BorderSizePixel = 0
controlPanel.Position = UDim2.new(0.5, -150, 0.5, -100)
controlPanel.Size = UDim2.new(0, 300, 0, 200)
controlPanel.AnchorPoint = Vector2.new(0.5, 0.5)
controlPanel.Visible = false
controlPanel.Parent = screenGui

local panelTitle = Instance.new("TextLabel")
panelTitle.Name = "PanelTitle"
panelTitle.Text = "Free Camera Active"
panelTitle.TextColor3 = Color3.fromRGB(100, 255, 100)
panelTitle.TextSize = 16
panelTitle.Font = Enum.Font.GothamBold
panelTitle.BackgroundTransparency = 1
panelTitle.Size = UDim2.new(1, 0, 0, 30)
panelTitle.Parent = controlPanel

-- Joystick for movement
local joystickFrame = Instance.new("Frame")
joystickFrame.Name = "JoystickFrame"
joystickFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
joystickFrame.BackgroundTransparency = 0.7
joystickFrame.BorderSizePixel = 0
joystickFrame.Position = UDim2.new(0.1, 0, 0.3, 0)
joystickFrame.Size = UDim2.new(0, CONFIG.JoystickSize, 0, CONFIG.JoystickSize)
joystickFrame.Parent = controlPanel

local joystickKnob = Instance.new("Frame")
joystickKnob.Name = "JoystickKnob"
joystickKnob.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
joystickKnob.BackgroundTransparency = 0.3
joystickKnob.BorderSizePixel = 0
joystickKnob.Size = UDim2.new(0, 40, 0, 40)
joystickKnob.AnchorPoint = Vector2.new(0.5, 0.5)
joystickKnob.Position = UDim2.new(0.5, 0, 0.5, 0)
joystickKnob.Parent = joystickFrame

local joystickLabel = Instance.new("TextLabel")
joystickLabel.Name = "JoystickLabel"
joystickLabel.Text = "Move"
joystickLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
joystickLabel.TextSize = 14
joystickLabel.Font = Enum.Font.Gotham
joystickLabel.BackgroundTransparency = 1
joystickLabel.Position = UDim2.new(0, 0, 1, 5)
joystickLabel.Size = UDim2.new(1, 0, 0, 20)
joystickLabel.Parent = joystickFrame

-- Speed controls
local speedFrame = Instance.new("Frame")
speedFrame.Name = "SpeedFrame"
speedFrame.BackgroundTransparency = 1
speedFrame.Position = UDim2.new(0.6, 0, 0.3, 0)
speedFrame.Size = UDim2.new(0, 100, 0, 120)
speedFrame.Parent = controlPanel

local speedLabel = Instance.new("TextLabel")
speedLabel.Name = "SpeedLabel"
speedLabel.Text = "Speed: " .. CONFIG.MoveSpeed
speedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
speedLabel.TextSize = 14
speedLabel.Font = Enum.Font.Gotham
speedLabel.BackgroundTransparency = 1
speedLabel.Size = UDim2.new(1, 0, 0, 20)
speedLabel.Parent = speedFrame

-- Speed buttons
local speedUpButton = Instance.new("TextButton")
speedUpButton.Name = "SpeedUpButton"
speedUpButton.Text = "+"
speedUpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
speedUpButton.TextSize = 18
speedUpButton.Font = Enum.Font.GothamBold
speedUpButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
speedUpButton.Position = UDim2.new(0.5, -15, 0.3, 0)
speedUpButton.Size = UDim2.new(0, 30, 0, 30)
speedUpButton.AnchorPoint = Vector2.new(0.5, 0)
speedUpButton.Parent = speedFrame

local speedDownButton = Instance.new("TextButton")
speedDownButton.Name = "SpeedDownButton"
speedDownButton.Text = "-"
speedDownButton.TextColor3 = Color3.fromRGB(255, 255, 255)
speedDownButton.TextSize = 18
speedDownButton.Font = Enum.Font.GothamBold
speedDownButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
speedDownButton.Position = UDim2.new(0.5, -15, 0.6, 0)
speedDownButton.Size = UDim2.new(0, 30, 0, 30)
speedDownButton.AnchorPoint = Vector2.new(0.5, 0)
speedDownButton.Parent = speedFrame

-- Instructions
local instructions = Instance.new("TextLabel")
instructions.Name = "Instructions"
instructions.Text = "Drag screen to look around\nTap Exit to return to normal"
instructions.TextColor3 = Color3.fromRGB(200, 200, 200)
instructions.TextSize = 12
instructions.Font = Enum.Font.Gotham
instructions.TextWrapped = true
instructions.BackgroundTransparency = 1
instructions.Position = UDim2.new(0.1, 0, 0.8, 0)
instructions.Size = UDim2.new(0.8, 0, 0, 40)
instructions.Parent = controlPanel

-- Exit button
local exitButton = Instance.new("TextButton")
exitButton.Name = "ExitButton"
exitButton.Text = "Exit Free Cam"
exitButton.TextColor3 = Color3.fromRGB(255, 255, 255)
exitButton.TextSize = 14
exitButton.Font = Enum.Font.GothamBold
exitButton.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
exitButton.Position = UDim2.new(0.3, 0, 0.9, -30)
exitButton.Size = UDim2.new(0.4, 0, 0, 30)
exitButton.Visible = false
exitButton.Parent = screenGui

-- Enable free camera
local function enableFreeCamera()
    freeCameraEnabled = true
    
    -- Store original camera state
    originalCFrame = camera.CFrame
    originalCameraType = camera.CameraType
    
    -- Start with current camera position
    cameraCFrame = camera.CFrame
    
    -- Enable camera control
    camera.CameraType = Enum.CameraType.Scriptable
    
    -- Update UI
    toggleButton.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
    toggleLabel.Text = "Free Cam ON"
    controlPanel.Visible = true
    exitButton.Visible = true
end

-- Disable free camera
local function disableFreeCamera()
    freeCameraEnabled = false
    
    -- Reset camera
    camera.CameraType = originalCameraType or Enum.CameraType.Custom
    camera.CFrame = originalCFrame or CFrame.new()
    
    -- Reset movement
    movementVector = Vector3.new()
    joystickTouch = nil
    lookTouch = nil
    lookDelta = Vector2.new()
    
    -- Reset joystick visual
    joystickKnob.Position = UDim2.new(0.5, 0, 0.5, 0)
    
    -- Update UI
    toggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    toggleLabel.Text = "Free Cam"
    controlPanel.Visible = false
    exitButton.Visible = false
end

-- Toggle free camera
toggleButton.MouseButton1Click:Connect(function()
    if freeCameraEnabled then
        disableFreeCamera()
    else
        enableFreeCamera()
    end
end)

-- Exit button
exitButton.MouseButton1Click:Connect(function()
    disableFreeCamera()
end)

-- Speed controls
speedUpButton.MouseButton1Click:Connect(function()
    CONFIG.MoveSpeed = math.min(CONFIG.MoveSpeed + 2, 50)
    speedLabel.Text = "Speed: " .. CONFIG.MoveSpeed
end)

speedDownButton.MouseButton1Click:Connect(function()
    CONFIG.MoveSpeed = math.max(CONFIG.MoveSpeed - 2, 1)
    speedLabel.Text = "Speed: " .. CONFIG.MoveSpeed
end)

-- Joystick controls
local joystickCenter = Vector2.new()

joystickFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch and not joystickTouch then
        joystickTouch = input
        joystickCenter = Vector2.new(
            joystickFrame.AbsolutePosition.X + joystickFrame.AbsoluteSize.X / 2,
            joystickFrame.AbsolutePosition.Y + joystickFrame.AbsoluteSize.Y / 2
        )
    end
end)

joystickFrame.InputChanged:Connect(function(input)
    if input == joystickTouch then
        local touchPos = input.Position
        local delta = touchPos - joystickCenter
        local maxDistance = CONFIG.JoystickSize / 2 - 20
        
        -- Clamp joystick position
        local distance = math.min(delta.Magnitude, maxDistance)
        local direction = delta.Unit
        
        -- Update joystick visual
        local knobPos = direction * distance
        joystickKnob.Position = UDim2.new(
            0.5, knobPos.X,
            0.5, knobPos.Y
        )
        
        -- Calculate movement vector
        movementVector = Vector3.new(
            direction.X * (distance / maxDistance),
            0,
            -direction.Y * (distance / maxDistance)
        )
    end
end)

joystickFrame.InputEnded:Connect(function(input)
    if input == joystickTouch then
        joystickTouch = nil
        movementVector = Vector3.new()
        -- Reset joystick visual
        joystickKnob.Position = UDim2.new(0.5, 0, 0.5, 0)
    end
end)

-- Look controls (drag anywhere on screen)
screenGui.InputBegan:Connect(function(input)
    if freeCameraEnabled and input.UserInputType == Enum.UserInputType.Touch and not lookTouch then
        lookTouch = input
        lookDelta = Vector2.new()
    end
end)

screenGui.InputChanged:Connect(function(input)
    if freeCameraEnabled and input == lookTouch then
        local delta = input.Delta
        lookDelta = Vector2.new(delta.X, delta.Y)
    end
end)

screenGui.InputEnded:Connect(function(input)
    if input == lookTouch then
        lookTouch = nil
        lookDelta = Vector2.new()
    end
end)

-- Camera update loop
RunService.RenderStepped:Connect(function(deltaTime)
    if freeCameraEnabled then
        -- Apply rotation from look controls
        if lookDelta.Magnitude > 0 then
            local yaw = -lookDelta.X * CONFIG.Sensitivity * 0.01
            local pitch = -lookDelta.Y * CONFIG.Sensitivity * 0.01
            
            -- Apply rotation to camera
            local currentRot = cameraCFrame - cameraCFrame.Position
            local yawRot = CFrame.fromAxisAngle(Vector3.new(0, 1, 0), yaw)
            local pitchRot = CFrame.fromAxisAngle(currentRot.RightVector, pitch)
            
            cameraCFrame = cameraCFrame * yawRot * pitchRot
        end
        
        -- Apply movement
        if movementVector.Magnitude > 0 then
            local moveDelta = movementVector * CONFIG.MoveSpeed * deltaTime
            
            -- Transform movement to camera space
            local forward = cameraCFrame.LookVector
            local right = cameraCFrame.RightVector
            local up = cameraCFrame.UpVector
            
            local worldMove = 
                right * moveDelta.X +
                up * moveDelta.Y +
                forward * moveDelta.Z
            
            cameraCFrame = cameraCFrame + worldMove
        end
        
        -- Apply camera update
        camera.CFrame = cameraCFrame
    end
end)

-- Cleanup
player.CharacterAdded:Connect(function()
    if freeCameraEnabled then
        disableFreeCamera()
    end
end)

game:GetService("GuiService").MenuOpened:Connect(function()
    if freeCameraEnabled then
        disableFreeCamera()
    end
end)

print("Free Camera Mobile System by sherikyt loaded!")
print("Tap the camera icon in the top-right corner to toggle free camera")
