-- âœ¨ Flight System by sherikyt
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RS = game:GetService("RunService")
local TS = game:GetService("TweenService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local humanoid = char:WaitForChild("Humanoid")
local hrp = char:WaitForChild("HumanoidRootPart")

-- Config
local flySpeed = 50
local isFlying = false
local flightCon
local flyBV, flyBG
local isDraggingButtons = false
local originalBtnPositions = {}

-- UI Creation Function
local function createElement(type, props)
    local element = Instance.new(type)
    for prop, value in pairs(props) do
        element[prop] = value
    end
    return element
end

-- Backgrounds
local backgrounds = {
    {
        name = "Default",
        color = Color3.fromRGB(30, 30, 45),
        transparency = 0.1
    },
    {
        name = "Space",
        color = Color3.fromRGB(10, 10, 30),
        transparency = 0.05,
        image = "rbxassetid://10859305527"
    },
    {
        name = "Cyberpunk",
        color = Color3.fromRGB(20, 10, 40),
        transparency = 0.1,
        gradient = {
            ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 0, 255)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 255, 255))
        }
    },
    {
        name = "Nature",
        color = Color3.fromRGB(20, 40, 20),
        transparency = 0.1,
        image = "rbxassetid://10859310099"
    },
    {
        name = "Sunset",
        color = Color3.fromRGB(45, 20, 30),
        transparency = 0.05,
        gradient = {
            ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 100, 0)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 0, 100))
        }
    }
}

local currentBackground = 1

-- Main GUI
local gui = createElement("ScreenGui", {
    Name = "FlightGUI",
    Parent = player.PlayerGui,
    ResetOnSpawn = false
})

-- Minimized Window
local minimizedWindow = createElement("Frame", {
    Name = "MinimizedWindow",
    Size = UDim2.new(0, 50, 0, 50),
    Position = UDim2.new(0, 20, 0.5, -25),
    BackgroundColor3 = Color3.fromRGB(40, 40, 60),
    BackgroundTransparency = 0.2,
    Visible = false
})
minimizedWindow.Parent = gui

createElement("UICorner", {
    CornerRadius = UDim.new(0, 10),
    Parent = minimizedWindow
})

local minimizedIcon = createElement("TextButton", {
    Name = "MinimizedIcon",
    Size = UDim2.new(1, 0, 1, 0),
    BackgroundTransparency = 1,
    Text = "ðŸ›¸",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 24,
    Parent = minimizedWindow
})

-- Main Flight Window
local flightWindow = createElement("Frame", {
    Name = "FlightWindow",
    Size = UDim2.new(0, 400, 0, 350),
    Position = UDim2.new(0.5, -200, 0.5, -175),
    BackgroundColor3 = backgrounds[currentBackground].color,
    BackgroundTransparency = backgrounds[currentBackground].transparency,
    ClipsDescendants = true
})
flightWindow.Parent = gui

-- Apply background image or gradient
if backgrounds[currentBackground].image then
    local bgImage = createElement("ImageLabel", {
        Image = backgrounds[currentBackground].image,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        ScaleType = Enum.ScaleType.Crop
    })
    bgImage.Parent = flightWindow
end

if backgrounds[currentBackground].gradient then
    local gradient = createElement("UIGradient", {
        Color = ColorSequence.new(backgrounds[currentBackground].gradient),
        Rotation = 45
    })
    gradient.Parent = flightWindow
end

createElement("UICorner", {
    CornerRadius = UDim.new(0, 15),
    Parent = flightWindow
})

-- Flight Window Header
local flightHeader = createElement("Frame", {
    Name = "FlightHeader",
    Size = UDim2.new(1, 0, 0, 40),
    BackgroundColor3 = Color3.fromRGB(40, 40, 60),
    BackgroundTransparency = 0.3
})
flightHeader.Parent = flightWindow

createElement("UICorner", {
    CornerRadius = UDim.new(0, 15),
    Parent = flightHeader
})

local flightTitle = createElement("TextLabel", {
    Name = "FlightTitle",
    Size = UDim2.new(0.7, 0, 1, 0),
    Position = UDim2.new(0, 10, 0, 0),
    BackgroundTransparency = 1,
    Text = "ðŸ›¸ Flight Control",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 18,
    TextXAlignment = Enum.TextXAlignment.Left,
    Parent = flightHeader
})

local flightCreator = createElement("TextLabel", {
    Name = "FlightCreator",
    Size = UDim2.new(0.7, 0, 0, 20),
    Position = UDim2.new(0, 10, 0, 45),
    BackgroundTransparency = 1,
    Text = "by sherikyt",
    TextColor3 = Color3.fromRGB(180, 180, 255),
    Font = Enum.Font.Gotham,
    TextSize = 14,
    TextXAlignment = Enum.TextXAlignment.Left,
    Parent = flightWindow
})

-- Close button
local closeBtn = createElement("TextButton", {
    Name = "CloseBtn",
    Size = UDim2.new(0, 30, 0, 30),
    Position = UDim2.new(1, -35, 0, 5),
    BackgroundColor3 = Color3.fromRGB(255, 80, 80),
    Text = "âœ•",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 18
})
closeBtn.Parent = flightHeader

createElement("UICorner", {
    CornerRadius = UDim.new(1, 0),
    Parent = closeBtn
})

-- Settings button
local settingsBtn = createElement("TextButton", {
    Name = "SettingsBtn",
    Size = UDim2.new(0, 30, 0, 30),
    Position = UDim2.new(1, -70, 0, 5),
    BackgroundColor3 = Color3.fromRGB(80, 80, 100),
    Text = "âš™ï¸",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 16
})
settingsBtn.Parent = flightHeader

createElement("UICorner", {
    CornerRadius = UDim.new(1, 0),
    Parent = settingsBtn
})

-- Speed Display
local speedDisplay = createElement("Frame", {
    Name = "SpeedDisplay",
    Size = UDim2.new(0.9, 0, 0, 50),
    Position = UDim2.new(0.05, 0, 0, 75),
    BackgroundColor3 = Color3.fromRGB(40, 40, 60),
    BackgroundTransparency = 0.3
})
speedDisplay.Parent = flightWindow

createElement("UICorner", {
    CornerRadius = UDim.new(0, 10),
    Parent = speedDisplay
})

local speedText = createElement("TextLabel", {
    Name = "SpeedText",
    Size = UDim2.new(1, 0, 1, 0),
    BackgroundTransparency = 1,
    Text = "SPEED: " .. flySpeed,
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 22,
    Parent = speedDisplay
})

-- Flight Controls Container
local controlsContainer = createElement("Frame", {
    Name = "ControlsContainer",
    Size = UDim2.new(0.9, 0, 0, 150),
    Position = UDim2.new(0.05, 0, 0, 140),
    BackgroundTransparency = 1
})
controlsContainer.Parent = flightWindow

-- Flight Control Buttons (QWERTY layout)
local controlButtons = {
    {
        name = "W",
        text = "W",
        position = UDim2.new(0.33, 0, 0, 0),
        action = "forward"
    },
    {
        name = "A",
        text = "A",
        position = UDim2.new(0, 0, 0.5, 0),
        action = "left"
    },
    {
        name = "S",
        text = "S",
        position = UDim2.new(0.33, 0, 0.5, 0),
        action = "back"
    },
    {
        name = "D",
        text = "D",
        position = UDim2.new(0.66, 0, 0.5, 0),
        action = "right"
    },
    {
        name = "Space",
        text = "â†‘",
        position = UDim2.new(0.33, 0, 1, -40),
        action = "up"
    },
    {
        name = "Ctrl",
        text = "â†“",
        position = UDim2.new(0.66, 0, 1, -40),
        action = "down"
    }
}

local flightBtns = {}

for _, btnData in ipairs(controlButtons) do
    local btn = createElement("TextButton", {
        Name = btnData.name,
        Size = UDim2.new(0, 40, 0, 40),
        Position = btnData.position,
        BackgroundColor3 = Color3.fromRGB(60, 60, 80),
        Text = btnData.text,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        Font = Enum.Font.GothamBold,
        TextSize = 16
    })
    btn.Parent = controlsContainer
    
    createElement("UICorner", {
        CornerRadius = UDim.new(0, 8),
        Parent = btn
    })
    
    originalBtnPositions[btn] = btnData.position
    flightBtns[btnData.action] = btn
end

-- Control Buttons (bottom row)
local controlRow = createElement("Frame", {
    Name = "ControlRow",
    Size = UDim2.new(0.9, 0, 0, 50),
    Position = UDim2.new(0.05, 0, 0, 300),
    BackgroundTransparency = 1
})
controlRow.Parent = flightWindow

-- Increase Speed
local increaseBtn = createElement("TextButton", {
    Name = "IncreaseBtn",
    Size = UDim2.new(0, 80, 0, 40),
    Position = UDim2.new(0, 0, 0, 5),
    BackgroundColor3 = Color3.fromRGB(40, 180, 40),
    Text = "+",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 24,
    Parent = controlRow
})

createElement("UICorner", {
    CornerRadius = UDim.new(0, 8),
    Parent = increaseBtn
})

-- Decrease Speed
local decreaseBtn = createElement("TextButton", {
    Name = "DecreaseBtn",
    Size = UDim2.new(0, 80, 0, 40),
    Position = UDim2.new(0.3, 0, 0, 5),
    BackgroundColor3 = Color3.fromRGB(220, 40, 40),
    Text = "-",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 24,
    Parent = controlRow
})

createElement("UICorner", {
    CornerRadius = UDim.new(0, 8),
    Parent = decreaseBtn
})

-- Fly Toggle
local flyToggleBtn = createElement("TextButton", {
    Name = "FlyToggleBtn",
    Size = UDim2.new(0, 120, 0, 40),
    Position = UDim2.new(0.6, 0, 0, 5),
    BackgroundColor3 = Color3.fromRGB(60, 100, 220),
    Text = "ðŸ›¸ FLY",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 16,
    Parent = controlRow
})

createElement("UICorner", {
    CornerRadius = UDim.new(0, 8),
    Parent = flyToggleBtn
})

-- Settings Window
local settingsWindow = createElement("Frame", {
    Name = "SettingsWindow",
    Size = UDim2.new(0, 350, 0, 300),
    Position = UDim2.new(0.5, -175, 0.5, -150),
    BackgroundColor3 = Color3.fromRGB(35, 35, 50),
    BackgroundTransparency = 0.1,
    Visible = false,
    ClipsDescendants = true
})
settingsWindow.Parent = gui

createElement("UICorner", {
    CornerRadius = UDim.new(0, 15),
    Parent = settingsWindow
})

-- Settings Header
local settingsHeader = createElement("Frame", {
    Name = "SettingsHeader",
    Size = UDim2.new(1, 0, 0, 40),
    BackgroundColor3 = Color3.fromRGB(45, 45, 65),
    BackgroundTransparency = 0.3,
    Parent = settingsWindow
})

createElement("UICorner", {
    CornerRadius = UDim.new(0, 15),
    Parent = settingsHeader
})

local settingsTitle = createElement("TextLabel", {
    Name = "SettingsTitle",
    Size = UDim2.new(0.7, 0, 1, 0),
    Position = UDim2.new(0, 10, 0, 0),
    BackgroundTransparency = 1,
    Text = "âš™ï¸ Settings",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 18,
    TextXAlignment = Enum.TextXAlignment.Left,
    Parent = settingsHeader
})

-- Close Settings button
local closeSettingsBtn = createElement("TextButton", {
    Name = "CloseSettingsBtn",
    Size = UDim2.new(0, 30, 0, 30),
    Position = UDim2.new(1, -35, 0, 5),
    BackgroundColor3 = Color3.fromRGB(80, 80, 100),
    Text = "â†",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 18,
    Parent = settingsHeader
})

createElement("UICorner", {
    CornerRadius = UDim.new(1, 0),
    Parent = closeSettingsBtn
})

-- Settings Content
local settingsContent = createElement("Frame", {
    Name = "SettingsContent",
    Size = UDim2.new(1, -20, 1, -60),
    Position = UDim2.new(0, 10, 0, 50),
    BackgroundTransparency = 1,
    Parent = settingsWindow
})

-- Background Selector
local bgLabel = createElement("TextLabel", {
    Name = "BgLabel",
    Size = UDim2.new(1, 0, 0, 30),
    BackgroundTransparency = 1,
    Text = "ðŸŽ¨ Select Background:",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 16,
    TextXAlignment = Enum.TextXAlignment.Left,
    Parent = settingsContent
})

local bgContainer = createElement("Frame", {
    Name = "BgContainer",
    Size = UDim2.new(1, 0, 0, 100),
    Position = UDim2.new(0, 0, 0, 35),
    BackgroundColor3 = Color3.fromRGB(40, 40, 60),
    BackgroundTransparency = 0.3,
    Parent = settingsContent
})

createElement("UICorner", {
    CornerRadius = UDim.new(0, 10),
    Parent = bgContainer
})

local bgButtons = {}
for i, bg in ipairs(backgrounds) do
    local bgBtn = createElement("TextButton", {
        Name = "BgBtn" .. i,
        Size = UDim2.new(0.18, 0, 0, 80),
        Position = UDim2.new(0.05 + (i-1) * 0.2, 0, 0.1, 0),
        BackgroundColor3 = bg.color,
        Text = bg.name,
        TextColor3 = Color3.fromRGB(255, 255, 255),
        Font = Enum.Font.Gotham,
        TextSize = 12,
        Parent = bgContainer
    })
    
    createElement("UICorner", {
        CornerRadius = UDim.new(0, 8),
        Parent = bgBtn
    })
    
    if i == currentBackground then
        local selection = createElement("Frame", {
            Size = UDim2.new(1, 4, 1, 4),
            Position = UDim2.new(0, -2, 0, -2),
            BackgroundColor3 = Color3.fromRGB(255, 255, 255),
            BackgroundTransparency = 0.7,
            Parent = bgBtn
        })
        
        createElement("UICorner", {
            CornerRadius = UDim.new(0, 10),
            Parent = selection
        })
    end
    
    bgButtons[i] = bgBtn
end

-- Button Dragging Toggle
local dragToggleContainer = createElement("Frame", {
    Name = "DragToggleContainer",
    Size = UDim2.new(1, 0, 0, 60),
    Position = UDim2.new(0, 0, 0, 150),
    BackgroundTransparency = 1,
    Parent = settingsContent
})

local dragLabel = createElement("TextLabel", {
    Name = "DragLabel",
    Size = UDim2.new(0.7, 0, 0, 30),
    BackgroundTransparency = 1,
    Text = "ðŸŽ® Rearrange Buttons:",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 16,
    TextXAlignment = Enum.TextXAlignment.Left,
    Parent = dragToggleContainer
})

local dragToggleBtn = createElement("TextButton", {
    Name = "DragToggleBtn",
    Size = UDim2.new(0, 60, 0, 30),
    Position = UDim2.new(0.7, 0, 0, 0),
    BackgroundColor3 = Color3.fromRGB(80, 80, 100),
    Text = "OFF",
    TextColor3 = Color3.fromRGB(255, 255, 255),
    Font = Enum.Font.GothamBold,
    TextSize = 14,
    Parent = dragToggleContainer
})

createElement("UICorner", {
    CornerRadius = UDim.new(0, 8),
    Parent = dragToggleBtn
})

local dragInfo = createElement("TextLabel", {
    Name = "DragInfo",
    Size = UDim2.new(1, 0, 0, 30),
    Position = UDim2.new(0, 0, 0, 30),
    BackgroundTransparency = 1,
    Text = "Toggle to drag buttons, toggle off to reset",
    TextColor3 = Color3.fromRGB(200, 200, 200),
    Font = Enum.Font.Gotham,
    TextSize = 12,
    TextXAlignment = Enum.TextXAlignment.Left,
    Parent = dragToggleContainer
})

-- Flight System
local function updateFlightStatus()
    if isFlying then
        flyToggleBtn.Text = "ðŸ›¸ FLYING"
        flyToggleBtn.BackgroundColor3 = Color3.fromRGB(40, 180, 40)
    else
        flyToggleBtn.Text = "ðŸ›¸ FLY"
        flyToggleBtn.BackgroundColor3 = Color3.fromRGB(60, 100, 220)
    end
end

local function startFlying()
    if not char or not hrp then return end
    
    humanoid.PlatformStand = true
    isFlying = true
    updateFlightStatus()
    
    -- Create flight controls
    flyBG = Instance.new("BodyGyro")
    flyBG.Name = "FlightGyro"
    flyBG.P = 10000
    flyBG.D = 1000
    flyBG.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
    flyBG.CFrame = hrp.CFrame
    flyBG.Parent = hrp
    
    flyBV = Instance.new("BodyVelocity")
    flyBV.Name = "FlightVelocity"
    flyBV.Velocity = Vector3.new(0, 0, 0)
    flyBV.MaxForce = Vector3.new(100000, 100000, 100000)
    flyBV.P = 1250
    flyBV.Parent = hrp
    
    -- Flight loop
    flightCon = RS.Heartbeat:Connect(function()
        if not isFlying or not flyBG or not flyBV or not hrp then return end
        
        local camera = workspace.CurrentCamera
        local moveDirection = Vector3.new(0, 0, 0)
        local lookVector = camera.CFrame.LookVector
        local rightVector = camera.CFrame.RightVector
        
        -- Check which buttons are being held
        local activeControls = {}
        for action, btn in pairs(flightBtns) do
            if btn:IsA("GuiButton") then
                activeControls[action] = btn.Active
            end
        end
        
        -- Apply movement based on active buttons
        if flightBtns.forward and flightBtns.forward.Active then
            moveDirection = moveDirection + lookVector
        end
        if flightBtns.back and flightBtns.back.Active then
            moveDirection = moveDirection - lookVector
        end
        if flightBtns.right and flightBtns.right.Active then
            moveDirection = moveDirection + rightVector
        end
        if flightBtns.left and flightBtns.left.Active then
            moveDirection = moveDirection - rightVector
        end
        if flightBtns.up and flightBtns.up.Active then
            moveDirection = moveDirection + Vector3.new(0, 1, 0)
        end
        if flightBtns.down and flightBtns.down.Active then
            moveDirection = moveDirection - Vector3.new(0, 1, 0)
        end
        
        if moveDirection.Magnitude > 0 then
            moveDirection = moveDirection.Unit
        end
        
        flyBV.Velocity = moveDirection * flySpeed
        flyBG.CFrame = CFrame.new(hrp.Position, hrp.Position + lookVector)
    end)
end

local function stopFlying()
    isFlying = false
    updateFlightStatus()
    
    if flightCon then
        flightCon:Disconnect()
        flightCon = nil
    end
    
    humanoid.PlatformStand = false
    
    if flyBG then flyBG:Destroy() end
    if flyBV then flyBV:Destroy() end
end

local function toggleFlying()
    if isFlying then
        stopFlying()
    else
        startFlying()
    end
end

-- Button Press/Release tracking for flight controls
for action, btn in pairs(flightBtns) do
    btn.MouseButton1Down:Connect(function()
        btn.Active = true
        btn.BackgroundColor3 = Color3.fromRGB(80, 80, 100)
    end)
    
    btn.MouseButton1Up:Connect(function()
        btn.Active = false
        btn.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    end)
    
    btn.MouseLeave:Connect(function()
        btn.Active = false
        btn.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    end)
end

-- Speed Controls
increaseBtn.MouseButton1Click:Connect(function()
    flySpeed = math.min(flySpeed + 10, 200)
    speedText.Text = "SPEED: " .. flySpeed
end)

decreaseBtn.MouseButton1Click:Connect(function()
    flySpeed = math.max(flySpeed - 10, 10)
    speedText.Text = "SPEED: " .. flySpeed
end)

-- Fly Toggle
flyToggleBtn.MouseButton1Click:Connect(toggleFlying)

-- Window Management
closeBtn.MouseButton1Click:Connect(function()
    flightWindow.Visible = false
    minimizedWindow.Visible = true
end)

minimizedIcon.MouseButton1Click:Connect(function()
    flightWindow.Visible = true
    minimizedWindow.Visible = false
end)

-- Settings Management
settingsBtn.MouseButton1Click:Connect(function()
    settingsWindow.Visible = true
end)

closeSettingsBtn.MouseButton1Click:Connect(function()
    settingsWindow.Visible = false
end)

-- Background Selection
for i, bgBtn in ipairs(bgButtons) do
    bgBtn.MouseButton1Click:Connect(function()
        currentBackground = i
        
        -- Update flight window background
        flightWindow.BackgroundColor3 = backgrounds[i].color
        flightWindow.BackgroundTransparency = backgrounds[i].transparency
        
        -- Clear existing background effects
        for _, child in ipairs(flightWindow:GetChildren()) do
            if child:IsA("ImageLabel") or child:IsA("UIGradient") then
                chil
