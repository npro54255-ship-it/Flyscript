-- Free Camera Mobile System by sherikyt
-- For mobile devices - Tap camera icon to toggle

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")

-- Check if mobile
local IS_MOBILE = UserInputService.TouchEnabled

if not IS_MOBILE then
    warn("This script is designed for mobile devices!")
    return
end

-- Configuration
local CONFIG = {
    MoveSpeed = 10,
    MouseSensitivity = 0.5,
    Smoothness = 0.8,
    JoystickSize = 120,
    ButtonSize = 60
}

-- UI Elements
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "FreeCameraMobileUI"
ScreenGui.ResetOnSpawn = false

-- Main container
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
MainFrame.BackgroundTransparency = 0.8
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.8, 0, 0.5, -100)
MainFrame.Size = UDim2.new(0, 150, 0, 400)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)

-- Title
local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Text = "Free Camera"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 16
Title.Font = Enum.Font.GothamBold
Title.BackgroundTransparency = 1
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Parent = MainFrame

-- Status label
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Name = "StatusLabel"
StatusLabel.Text = "OFF"
StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
StatusLabel.TextSize = 14
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.BackgroundTransparency = 1
StatusLabel.Position = UDim2.new(0, 0, 0, 40)
StatusLabel.Size = UDim2.new(1, 0, 0, 30)
StatusLabel.Parent = MainFrame

-- Toggle button (Camera icon)
local ToggleButton = Instance.new("ImageButton")
ToggleButton.Name = "ToggleButton"
ToggleButton.Image = "rbxassetid://7072717646" -- Camera icon
ToggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
ToggleButton.Position = UDim2.new(0.5, -CONFIG.ButtonSize/2, 0, 80)
ToggleButton.Size = UDim2.new(0, CONFIG.ButtonSize, 0, CONFIG.ButtonSize)
ToggleButton.AnchorPoint = Vector2.new(0.5, 0)
ToggleButton.Parent = MainFrame

-- Joystick for movement
local JoystickFrame = Instance.new("Frame")
JoystickFrame.Name = "JoystickFrame"
JoystickFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
JoystickFrame.BackgroundTransparency = 0.7
JoystickFrame.BorderSizePixel = 0
JoystickFrame.Position = UDim2.new(0, 20, 0, 160)
JoystickFrame.Size = UDim2.new(0, CONFIG.JoystickSize, 0, CONFIG.JoystickSize)
JoystickFrame.Visible = false
JoystickFrame.Parent = MainFrame

-- Joystick knob
local JoystickKnob = Instance.new("Frame")
JoystickKnob.Name = "JoystickKnob"
JoystickKnob.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
JoystickKnob.BackgroundTransparency = 0.3
JoystickKnob.BorderSizePixel = 0
JoystickKnob.Size = UDim2.new(0, 40, 0, 40)
JoystickKnob.AnchorPoint = Vector2.new(0.5, 0.5)
JoystickKnob.Position = UDim2.new(0.5, 0, 0.5, 0)
JoystickKnob.Parent = JoystickFrame

-- Look controls area
local LookFrame = Instance.new("Frame")
LookFrame.Name = "LookFrame"
LookFrame.BackgroundTransparency = 1
LookFrame.Size = UDim2.new(1, 0, 0.5, 0)
LookFrame.Position = UDim2.new(0, 0, 0.5, 0)
LookFrame.Visible = false
LookFrame.Parent = ScreenGui

-- Speed controls
local SpeedFrame = Instance.new("Frame")
SpeedFrame.Name = "SpeedFrame"
SpeedFrame.BackgroundTransparency = 1
SpeedFrame.Position = UDim2.new(0, 20, 0, 300)
SpeedFrame.Size = UDim2.new(1, -40, 0, 80)
SpeedFrame.Parent = MainFrame

local SpeedLabel = Instance.new("TextLabel")
SpeedLabel.Name = "SpeedLabel"
SpeedLabel.Text = "Speed: " .. CONFIG.MoveSpeed
SpeedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedLabel.TextSize = 14
SpeedLabel.Font = Enum.Font.Gotham
SpeedLabel.BackgroundTransparency = 1
SpeedLabel.Size = UDim2.new(1, 0, 0, 20)
SpeedLabel.Parent = SpeedFrame

-- Speed slider
local SpeedSlider = Instance.new("Frame")
SpeedSlider.Name = "SpeedSlider"
SpeedSlider.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
SpeedSlider.BorderSizePixel = 0
SpeedSlider.Position = UDim2.new(0, 0, 0, 30)
SpeedSlider.Size = UDim2.new(1, 0, 0, 20)
SpeedSlider.Parent = SpeedFrame

local SpeedFill = Instance.new("Frame")
SpeedFill.Name = "SpeedFill"
SpeedFill.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
SpeedFill.BorderSizePixel = 0
SpeedFill.Size = UDim2.new(0.5, 0, 1, 0)
SpeedFill.Parent = SpeedSlider

local SpeedKnob = Instance.new("Frame")
SpeedKnob.Name = "SpeedKnob"
SpeedKnob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
SpeedKnob.BorderSizePixel = 0
SpeedKnob.Size = UDim2.new(0, 10, 1.5, 0)
SpeedKnob.AnchorPoint = Vector2.new(0.5, 0.5)
SpeedKnob.Position = UDim2.new(0.5, 0, 0.5, 0)
SpeedKnob.Parent = SpeedSlider

-- Parent UI
ScreenGui.Parent = CoreGui

-- Variables
local player = Players.LocalPlayer
local camera = workspace.CurrentCamera
local freeCameraEnabled = false
local originalCFrame
local originalFocus
local cameraCFrame = CFrame.new()

-- Movement vectors
local movementVector = Vector3.new()
local joystickTouch = nil
local joystickCenter = Vector2.new()
local lookTouch = nil
local lookStartPos = Vector2.new()

-- Speed control
local currentSpeed = CONFIG.MoveSpeed
local minSpeed = 1
local maxSpeed = 50

-- Update speed display
local function updateSpeedDisplay()
    SpeedLabel.Text = "Speed: " .. math.floor(currentSpeed)
    local fillAmount = (currentSpeed - minSpeed) / (maxSpeed - minSpeed)
    SpeedFill.Size = UDim2.new(fillAmount, 0, 1, 0)
    SpeedKnob.Position = UDim2.new(fillAmount, 0, 0.5, 0)
end

-- Touch events for speed slider
local speedSliderTouch = nil

SpeedSlider.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch then
        speedSliderTouch = input
    end
end)

SpeedSlider.InputChanged:Connect(function(input)
    if input == speedSliderTouch then
        local sliderPos = input.Position.X - SpeedSlider.AbsolutePosition.X
        local sliderWidth = SpeedSlider.AbsoluteSize.X
        local normalizedPos = math.clamp(sliderPos / sliderWidth, 0, 1)
        
        currentSpeed = minSpeed + (maxSpeed - minSpeed) * normalizedPos
        updateSpeedDisplay()
    end
end)

SpeedSlider.InputEnded:Connect(function(input)
    if input == speedSliderTouch then
        speedSliderTouch = nil
    end
end)

-- Initialize speed
updateSpeedDisplay()

-- Enable free camera
local function enableFreeCamera()
    freeCameraEnabled = true
    StatusLabel.Text = "ON"
    StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
    ToggleButton.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
    
    -- Store original camera state
    originalCFrame = camera.CFrame
    originalFocus = camera.Focus
    
    -- Start with current camera position
    cameraCFrame = camera.CFrame
    
    -- Show controls
    JoystickFrame.Visible = true
    LookFrame.Visible = true
    
    -- Enable camera control
    camera.CameraType = Enum.CameraType.Scriptable
end

-- Disable free camera
local function disableFreeCamera()
    freeCameraEnabled = false
    StatusLabel.Text = "OFF"
    StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
    ToggleButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    
    -- Hide controls
    JoystickFrame.Visible = false
    LookFrame.Visible = false
    
    -- Reset camera
    camera.CameraType = Enum.CameraType.Custom
    camera.CFrame = originalCFrame
    camera.Focus = originalFocus
    
    -- Reset movement
    movementVector = Vector3.new()
    joystickTouch = nil
    lookTouch = nil
end

-- Toggle free camera
ToggleButton.MouseButton1Click:Connect(function()
    if freeCameraEnabled then
        disableFreeCamera()
    else
        enableFreeCamera()
    end
end)

-- Joystick controls
JoystickFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.Touch and not joystickTouch then
        joystickTouch = input
        joystickCenter = Vector2.new(
            JoystickFrame.AbsolutePosition.X + JoystickFrame.AbsoluteSize.X / 2,
            JoystickFrame.AbsolutePosition.Y + JoystickFrame.AbsoluteSize.Y / 2
        )
        JoystickKnob.Position = UDim2.new(0.5, 0, 0.5, 0)
    end
end)

JoystickFrame.InputChanged:Connect(function(input)
    if input == joystickTouch then
        local touchPos = input.Position
        local delta = touchPos - joystickCenter
        local maxDistance = CONFIG.JoystickSize / 2 - 20
        
        -- Clamp joystick position
        local distance = math.min(delta.Magnitude, maxDistance)
        local direction = delta.Unit
        
        -- Update joystick visual
        local knobPos = direction * distance
        JoystickKnob.Position = UDim2.new(
            0.5, knobPos.X,
            0.5, knobPos.Y
        )
        
        -- Calculate movement vector
        movementVector = Vector3.new(
            direction.X * (distance / maxDistance),
            0,
            -direction.Y * (distance / maxDistance)
        )
    end
end)

JoystickFrame.InputEnded:Connect(function(input)
    if input == joystickTouch then
        joystickTouch = nil
        movementVector = Vector3.new()
        -- Reset joystick visual
        JoystickKnob.Position = UDim2.new(0.5, 0, 0.5, 0)
    end
end)

-- Look controls
LookFrame.InputBegan:Connect(function(input)
    if freeCameraEnabled and input.UserInputType == Enum.UserInputType.Touch and not lookTouch then
        lookTouch = input
        lookStartPos = input.Position
    end
end)

LookFrame.InputChanged:Connect(function(input)
    if freeCameraEnabled and input == lookTouch then
        local delta = input.Position - lookStartPos
        lookStartPos = input.Position
        
        -- Apply rotation
        local yaw = -delta.X * CONFIG.MouseSensitivity * 0.01
        local pitch = -delta.Y * CONFIG.MouseSensitivity * 0.01
        
        -- Apply rotation to camera
        local currentRot = cameraCFrame - cameraCFrame.Position
        local yawRot = CFrame.fromAxisAngle(Vector3.new(0, 1, 0), yaw)
        local pitchRot = CFrame.fromAxisAngle(currentRot.RightVector, pitch)
        
        cameraCFrame = cameraCFrame * yawRot * pitchRot
    end
end)

LookFrame.InputEnded:Connect(function(input)
    if input == lookTouch then
        lookTouch = nil
    end
end)

-- Camera update loop
RunService.RenderStepped:Connect(function(deltaTime)
    if freeCameraEnabled then
        -- Apply movement
        local moveDelta = movementVector * currentSpeed * deltaTime
        
        if moveDelta.Magnitude > 0 then
            -- Transform movement to camera space
            local forward = cameraCFrame.LookVector
            local right = cameraCFrame.RightVector
            local up = cameraCFrame.UpVector
            
            local worldMove = 
                right * moveDelta.X +
                up * moveDelta.Y +
                forward * moveDelta.Z
            
            cameraCFrame = cameraCFrame + worldMove
        end
        
        -- Apply smoothed camera update
        camera.CFrame = camera.CFrame:Lerp(cameraCFrame, CONFIG.Smoothness)
        camera.Focus = camera.CFrame * CFrame.new(0, 0, -10)
    end
end)

-- Cleanup on player leaving
player.CharacterAdded:Connect(function()
    if freeCameraEnabled then
        disableFreeCamera()
    end
end)

game:GetService("CoreGui").ChildRemoved:Connect(function(child)
    if child == ScreenGui then
        if freeCameraEnabled then
            disableFreeCamera()
        end
    end
end)

-- Initial setup
LookFrame.Size = UDim2.new(1, 0, 1, 0)

print("Free Camera Mobile System by sherikyt loaded!")
print("Tap the camera icon to toggle free camera")
print("Use joystick for movement, drag screen to look around")
